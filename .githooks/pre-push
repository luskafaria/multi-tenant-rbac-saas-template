#!/bin/sh

# Pre-push hook: Prevents pushing commits with lint, formatting, or type errors

echo "Running pre-push checks..."

# Run lint
echo "Checking lint..."
pnpm lint
LINT_STATUS=$?

if [ $LINT_STATUS -ne 0 ]; then
  echo "❌ Lint check failed. Please fix lint errors before pushing."
  exit 1
fi

# Run format check
echo "Checking formatting..."
pnpm format:check
FORMAT_STATUS=$?

if [ $FORMAT_STATUS -ne 0 ]; then
  echo "❌ Format check failed. Run 'pnpm format' to fix formatting issues."
  exit 1
fi

# Run typecheck
echo "Checking types..."
pnpm typecheck
TYPE_STATUS=$?

if [ $TYPE_STATUS -ne 0 ]; then
  echo "❌ Type check failed. Please fix type errors before pushing."
  exit 1
fi

echo "✅ All checks passed. Pushing..."
exit 0
